"use strict";(self.webpackChunkgatsby_starter_default=self.webpackChunkgatsby_starter_default||[]).push([[249],{3391:function(e,t,r){r.r(t);var s=r(7294);async function o(e){let{setMessage:t}=e;try{var r;const e=await fetch("https://rare-coral-35556.upstash.io/subscribe/test-channel",{method:"POST",headers:{Authorization:"Bearer xxxxxxxxx",Accept:"text/event-stream"}});if(!e.ok)throw new Error("Subscription failed: "+e.statusText);const t=null===(r=e.body)||void 0===r?void 0:r.getReader();if(!t)throw new Error("Failed to get response reader");const a=new TextDecoder;let n="";for(;;){var s;const{value:e,done:r}=await t.read();if(r)break;n+=a.decode(e,{stream:!0});const o=n.split("\n");n=null!==(s=o.pop())&&void 0!==s?s:"";for(const t of o)t.startsWith("data: ")&&console.log("Received message:",t.slice(6).trim())}console.log("Connection closed, reconnecting..."),setTimeout(o,5e3)}catch(a){console.error("Subscription error:",a),setTimeout(o,5e3)}}t.default=()=>{const{0:e,1:t}=(0,s.useState)([]);return(0,s.useEffect)((()=>{o(t)}),[]),s.createElement("div",null,s.createElement("h1",null,"Upstash Pub/Sub Test ",4),s.createElement("p",null,"Waiting for messages from Upstash..."),s.createElement("ul",null,e.map(((e,t)=>s.createElement("li",{key:t},e)))))}}}]);
//# sourceMappingURL=component---src-pages-sms-tsx-12f323a4a8999771abfc.js.map