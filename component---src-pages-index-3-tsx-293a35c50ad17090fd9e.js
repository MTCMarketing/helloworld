"use strict";(self.webpackChunkgatsby_starter_default=self.webpackChunkgatsby_starter_default||[]).push([[808],{8526:function(e,t,n){var r=n(7294),c=n(6118),o=n(4854),s=n(1433);t.Z=e=>{let{children:t}=e;const{0:n,1:a}=(0,r.useState)(null),{0:l,1:u}=(0,r.useState)(!0);return(0,r.useEffect)((()=>{const e=(0,c.Aj)(s.I,(e=>{e?a(e):(0,o.navigate)("/login"),u(!1)}));return()=>e()}),[]),l?r.createElement("p",null,"Loading..."):n?t(n):null}},3582:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var r=n(7294),c=n(8526);const o=e=>{let{children:t}=e;const{0:c,1:o}=(0,r.useState)(void 0),{0:s,1:a}=(0,r.useState)(!0);return(0,r.useEffect)((()=>{c||(async()=>{try{const e=await async function(){try{return await n.e(423).then(n.bind(n,9423))}catch(e){return void console.error("Failed to load Twilio Client:",e)}}();o(e),a(!1)}catch(e){console.error("Error fetching Twilio client:",e),a(!1)}})()}),[c]),s?r.createElement("p",null,"Loading..."):r.createElement(r.Fragment,null,c?t(c):null)};var s=n(5785);const a=e=>{let{wsRef:t,url:n,baseReconnectDelay:r,maxReconnectDelay:c,reconnectAttemptsRef:o,maxAttemptsBeforeAlert:s}=e;t.current&&t.current.readyState!==WebSocket.CLOSED&&t.current.close();const a=Math.min(r*Math.pow(2,o.current),c);o.current+=1,o.current>=s&&console.warn("WebSocket reconnection failed "+s+" times. Please check the server."),setTimeout((()=>{t.current=new WebSocket(n),t.current.onopen=()=>{console.log("✅ WebSocket reconnected"),o.current=0}}),a)},l=e=>{const{0:t,1:n}=(0,r.useState)([]),c=(0,r.useRef)(null),o=(0,r.useRef)(0);return(0,r.useEffect)((()=>((e=>{let{wsRef:t,url:n,reconnectAttemptsRef:r,onMessageReceived:c,onError:o,onOpen:s,onClose:l}=e;t.current&&t.current.readyState!==WebSocket.CLOSED&&t.current.close(),t.current=new WebSocket(n),t.current.onopen=()=>{console.log("✅ WebSocket connected"),r.current=0,s&&s()},t.current.onmessage=e=>{if(c)c(e);else try{const t=JSON.parse(e.data);console.log("📩 New message:",t)}catch(t){console.error("❌ Failed to parse WebSocket message:",t)}},t.current.onerror=e=>{o?o(e):(console.error("❌ WebSocket Error:",e),a({wsRef:t,url:n,reconnectAttemptsRef:r,baseReconnectDelay:5e3,maxReconnectDelay:15e3,maxAttemptsBeforeAlert:5}))},t.current.onclose=()=>{l?l():(console.log("🔴 WebSocket disconnected. Reconnecting..."),a({wsRef:t,url:n,reconnectAttemptsRef:r,baseReconnectDelay:5e3,maxReconnectDelay:15e3,maxAttemptsBeforeAlert:5}))}})({wsRef:c,url:e,reconnectAttemptsRef:o,onMessageReceived:e=>{try{const t=JSON.parse(e.data);n((e=>[].concat((0,s.Z)(e),[t])))}catch(t){console.error("❌ Failed to parse WebSocket message:",t)}}}),()=>{c.current&&c.current.close()})),[e]),{incomingSms:t}};var u=()=>{const{incomingSms:e}=l("wss://makethemcall.me/ws/");return r.createElement(c.Z,null,(t=>r.createElement(o,null,(t=>r.createElement(r.Fragment,null,e)))))}}}]);
//# sourceMappingURL=component---src-pages-index-3-tsx-293a35c50ad17090fd9e.js.map