"use strict";(self.webpackChunkgatsby_starter_default=self.webpackChunkgatsby_starter_default||[]).push([[249],{3391:function(e,t,s){s.r(t);var r=s(7294);const o="AYrkAAIjcDFjZDZlODJmNzQ2YzI0M2JiOGU5YjE2ZWU3MGMwMjI1OHAxMA";async function a(e){let{setMessage:t}=e;console.log("!!");try{var s;const e=await fetch("https://rare-coral-35556.upstash.io/subscribe/test-channel",{method:"POST",headers:{Authorization:"Bearer "+o,Accept:"text/event-stream"}});if(!e.ok)throw new Error("Subscription failed: "+e.statusText);const t=null===(s=e.body)||void 0===s?void 0:s.getReader();if(!t)throw new Error("Failed to get response reader");const n=new TextDecoder;let c="";for(;;){var r;const{value:e,done:s}=await t.read();if(s)break;c+=n.decode(e,{stream:!0});const o=c.split("\n");c=null!==(r=o.pop())&&void 0!==r?r:"";for(const t of o)t.startsWith("data: ")&&console.log("Received message:",t.slice(6).trim())}console.log("Connection closed, reconnecting..."),setTimeout(a,5e3)}catch(n){console.error("Subscription error:",n),setTimeout(a,5e3)}}t.default=()=>{const{0:e,1:t}=(0,r.useState)([]),{0:s,1:o}=(0,r.useState)(!1),{0:n,1:c}=(0,r.useState)(""),{0:l,1:i}=(0,r.useState)([]);return(0,r.useEffect)((()=>{a(t)}),[]),r.createElement("div",null,r.createElement("h1",null,"Upstash Pub/Sub Test ",4),r.createElement("p",null,"Waiting for messages from Upstash..."),r.createElement("ul",null,e.map(((e,t)=>r.createElement("li",{key:t},e)))))}}}]);
//# sourceMappingURL=component---src-pages-sms-tsx-8ecd22f9637da057b4c3.js.map