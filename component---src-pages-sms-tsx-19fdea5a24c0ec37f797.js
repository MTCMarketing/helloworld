"use strict";(self.webpackChunkgatsby_starter_default=self.webpackChunkgatsby_starter_default||[]).push([[249],{3391:function(e,t,s){s.r(t);var r=s(7294);const o="AYrkAAIjcDFjZDZlODJmNzQ2YzI0M2JiOGU5YjE2ZWU3MGMwMjI1OHAxMA";async function a(){console.log("!!");try{var e;const s=await fetch("https://rare-coral-35556.upstash.io/subscribe/test-channel",{method:"POST",headers:{Authorization:"Bearer "+o,Accept:"text/event-stream"}});if(!s.ok)throw new Error("Subscription failed: "+s.statusText);const r=null===(e=s.body)||void 0===e?void 0:e.getReader();if(!r)throw new Error("Failed to get response reader");const n=new TextDecoder;let c="";for(;;){var t;const{value:e,done:s}=await r.read();if(s)break;c+=n.decode(e,{stream:!0});const o=c.split("\n");c=null!==(t=o.pop())&&void 0!==t?t:"";for(const t of o)t.startsWith("data: ")&&console.log("Received message:",t.slice(6).trim())}console.log("Connection closed, reconnecting..."),setTimeout(a,5e3)}catch(s){console.error("Subscription error:",s),setTimeout(a,5e3)}}t.default=()=>{const{0:e,1:t}=(0,r.useState)([]),{0:s,1:o}=(0,r.useState)(!1),{0:n,1:c}=(0,r.useState)(""),{0:l,1:i}=(0,r.useState)([]);return(0,r.useEffect)((()=>{a()}),[]),r.createElement("div",null,r.createElement("h1",null,"Upstash Pub/Sub Test"),r.createElement("p",null,"Waiting for messages from Upstash..."),r.createElement("ul",null,l.map(((e,t)=>r.createElement("li",{key:t},e)))))}}}]);
//# sourceMappingURL=component---src-pages-sms-tsx-19fdea5a24c0ec37f797.js.map